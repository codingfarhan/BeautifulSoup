import requests

from bs4 import BeautifulSoup

import csv

import pandas as pd


url = "https://en.wikipedia.org/wiki/List_of_cities_in_Australia_by_population#50_largest_urban_centres_by_population"

r = requests.get(url)

htmlcontent = r.content

soup = BeautifulSoup(htmlcontent,'html.parser')
city_containers = soup.find_all("tr")

city_containers.pop(0)

l1 = []
l2 = []
l3 = []
l4 = []

for index, city in enumerate(city_containers, start=1):
    
    
    num = city.td.string
    
    if int(num)>5:
        city_name = city.td.find_next_sibling("td").a.string
    
    elif int(num)<=5:
        city_name = city.td.find_next_sibling("td").b.a.string
    
    
    population = city.td.find_next_siblings("td",style="text-align:right")[0].string
    
    perc_nat = city.td.find_next_siblings("td",style="text-align:right")[2].string
   
    l1.append(num)
    l2.append(city_name.replace(' ','-'))
    l3.append(population)
    l4.append(perc_nat)
     
    if index==96:
        break

dict = {'Rank':l1, 'City':l2, 'Estimated Population (in crores)':l3, 'Percentage of National Population':l4}

df = pd.DataFrame(dict)

df.to_csv('Pop_Cities_AUS.csv')
